echo "ğŸ” Running pre-commit checks..."

# 1. TypeScript type checking
echo "ğŸ“ Running TypeScript type check..."
npm run build || (echo "âŒ TypeScript errors found" && exit 1)

# 2. Check formatting
echo "ğŸ¨ Checking code formatting..."
npm run format:check || (echo "âŒ Code formatting issues found. Run 'npm run format' to fix." && exit 1)

# 3. Check ESLint rules
echo "ğŸ” Checking ESLint rules..."
npm run lint:check || (echo "âŒ ESLint issues found" && exit 1)

# 4. Run unit tests
echo "ğŸ§ª Running unit tests..."
npm test -- --run || (echo "âŒ Unit tests failed" && exit 1)

# 5. Run E2E tests (only if dev server is running)
echo "ğŸš€ Checking if dev server is running for E2E tests..."
if curl -s http://localhost:5173 > /dev/null 2>&1; then
    echo "ğŸ­ Running E2E tests..."
    npm run test:e2e || (echo "âŒ E2E tests failed" && exit 1)
else
    echo "âš ï¸  Dev server not running - skipping E2E tests"
    echo "   To run E2E tests, start dev server with: npm run dev"
fi

echo "âœ… All pre-commit checks passed!"
